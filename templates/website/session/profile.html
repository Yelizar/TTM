{% extends "website/base.html" %}
{% block titel %} Profile {% endblock %}
{% block content %}
    <h4> Profile page </h4>
    {% if user.is_authenticated %}

        <div style="float: left; width: 50%; height: 500px">
            <h5>General Profile details</h5>
            <p>Username: {{ user.username }}</p>
            <p>First Name: {{ user.first_name }}</p>
            <p>Last Name: {{ user.last_name }}</p>
            <p>Email: {{ user.email }}</p>
            <p>Role: {{ user.role }}</p>
            <p>Account created: {{ user.date_joined }}</p>
            <p>Last Login: {{ user.last_login }}</p>
            <p>Time now: {{ now }}</p>
        </div>
        {% if user.role == 'Student' %}
            <p>Find tutors online</p>
            <button class="primaryAction" type="submit"><a href="{% url 'session:search' %}">Find</a></button>
            <br>
        {% elif user.role == 'Tutor' %}

            <div style="float: left;  width: 50%">
                <h5>Tutor details</h5>
                <p>DoB: {{ user.tutordetails.dob }}</p>
                <p>CV: {{ user.tutordetails.cv_name }}</p>
                <p>Resume: {{ user.tutordetails.short_resume }}</p>
                <p>Phone: {{ user.tutordetails.phone_number }}</p>
            </div>
            <button class="primaryAction" type="submit"><a
                    href="{% url 'session:update-tutor-details' user.tutordetails.user_id %}">Edit</a></button>
            {% if user.tutordetails.is_active %}
                <p>Dear Tutor, yours details has been approved by manager.<br>
                    Now you are able to change your status.</p>
                {% if user.tutorstatus.is_active %}
                    You are in standby student mode
                    <form class="access-form" method="POST" action="">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button class="primaryAction" type="submit">Submit</button>
                </form>
                    {% else %}
                    Check the tick to be searchable by students
                    <form class="access-form" method="POST" action="">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button class="primaryAction" type="submit">Submit</button>
                {% endif %}
            {% else %}
                <p>Dear Tutor, yours details still hasn't been approved.<br>
                    You'll receive an email when our manager finishes your case.</p>
            {% endif %}
        {% endif %}
    {% else %}
        You are not authorized. Please log in or register on the website
        <button class="primaryAction" type="submit"><a href="{% url 'access:registration' %}">Registration</a></button>
        OR
        <button class="primaryAction" type="submit"><a href="{% url 'access:login' %}">Login</a></button>
        <h1>OAuth</h1>
        <a class="btn btn-primary" href="{% url 'access:social:begin' 'google-oauth2' %}">
            Login with Gmail
        </a>
    {% endif %}
    <div style="float: left; width: 100%; margin-top: 150px">
        <button class="primaryAction" type="submit"><a href="{% url 'access:home' %}"> Home </a></button>
        <button class="primaryAction" type="submit"><a href="{% url 'access:logout' %}"> Logout </a></button>
    </div>


{% endblock %}